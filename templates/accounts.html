<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account Page</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='accounts.css') }}">
    <style>
        .order-item, .appointment-item {
            border: 1px solid #ddd;
            padding: 12px;
            margin: 8px 0;
            border-radius: 5px;
            display: flex;
            align-items: center;
        }
        .order-image {
            width: 80px;
            height: 80px;
            margin-right: 16px;
            border-radius: 5px;
            object-fit: cover;
        }
        #orders-section, #appointments-section {
            display: none;
        }
        .back-home {
            text-align: center;
            margin-top: 20px;
        }
        .back-home button {
            padding: 10px 20px;
            background-color: #4CAF50;
            border: none;
            border-radius: 5px;
            color: white;
            font-size: 16px;
            cursor: pointer;
        }
        .back-home button:hover {
            background-color: #1cf75e;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Your Account</h1>
            <div class="user-info">
                <div class="user-name">
                    <span>Name: {{ user_name }}</span>
                </div>   
            </div>
        </div>

        <div class="options">
            <h2>Account Options</h2>
            <ul>
                <li><a href="#pet" onclick="navigateTo('pet')">Add Pet</a></li>
                <li><a href="#cart" onclick="navigateTo('cart')">My Cart</a></li>
                <li><a href="#orders" onclick="navigateTo('orders')">My Orders</a></li>
                <li><a href="#appointments" onclick="navigateTo('appointments')">My Appointments</a></li>
                <li><a href="#logout" onclick="navigateTo('log-out')">Log Out</a></li>
            </ul>
        </div>
        
        <!-- My Orders Section -->
        <div id="orders-section">
            <h2>Your Orders</h2>
            <div id="orders-list">
                <!-- Orders will be injected here -->
            </div>
        </div>

        <!-- My Appointments Section -->
        <div id="appointments-section">
            <h2>Your Appointments</h2>
            <div id="appointments-list">
                <!-- Appointments will be injected here -->
            </div>
        </div>
    </div>
    <div class="back-home">
        <button onclick="goHome()">Back to Home Page</button>
    </div>

    <script>
        function navigateTo(section) {
            if (section === 'cart') {
                window.location.href = "{{ url_for('cart') }}";
            } else if (section === 'orders') {
                document.getElementById('orders-section').style.display = 'block';
                document.getElementById('appointments-section').style.display = 'none';
                loadOrders();
            } else if (section === 'appointments') {
                document.getElementById('appointments-section').style.display = 'block';
                document.getElementById('orders-section').style.display = 'none';
                loadAppointments();
            } else if (section === 'pet') {
                window.location.href = "{{ url_for('pet') }}";
            } else {
                alert("Navigating to: " + section);
            }
        }

        // Save order function called during ordering
        function saveOrder(name, price, date, imageUrl, deliveryDate) {
            const orders = JSON.parse(localStorage.getItem('orders')) || [];
            orders.push({ name, price, date, imageUrl, deliveryDate });
            localStorage.setItem('orders', JSON.stringify(orders));
        }

        // Load orders and display them in "My Orders" section
        function loadOrders() {
            const orders = JSON.parse(localStorage.getItem('orders')) || [];
            const ordersList = document.getElementById('orders-list');

            ordersList.innerHTML = '';

            if (orders.length === 0) {
                ordersList.innerHTML = '<p>No orders found.</p>';
            } else {
                orders.forEach((order) => {
                    const orderItem = document.createElement('div');
                    orderItem.classList.add('order-item');
                    orderItem.innerHTML = `
                        <img src="${order.imageUrl}" alt="Order Image" class="order-image">
                        <div>
                            <p><strong>${order.name}</strong></p>
                            <p>Price: Rs.${order.price}</p>
                            <p>Ordered on: ${order.date}</p>
                            <p>Delivery Date: ${order.deliveryDate}</p>
                        </div>
                    `;
                    ordersList.appendChild(orderItem);
                });
            }
        }

        // Load appointments function to be implemented as needed
        function loadAppointments() {
            const appointments = JSON.parse(localStorage.getItem('appointments')) || [];
            const appointmentsList = document.getElementById('appointments-list');

            appointmentsList.innerHTML = '';

            if (appointments.length === 0) {
                appointmentsList.innerHTML = '<p>No appointments found.</p>';
            } else {
                appointments.forEach((appointment) => {
                    const appointmentItem = document.createElement('div');
                    appointmentItem.classList.add('appointment-item');
                    appointmentItem.innerHTML = `
                        <p>Name:<strong>${appointment.name}</strong></p>
                        <p> 
                    Date: ${appointment.date}</p>
                        <p>  
                            Time: ${appointment.time}</p>
                    `;
                    appointmentsList.appendChild(appointmentItem);
                });
            }
        }

        function goHome() {
            window.location.href = "{{ url_for('home') }}";
        }
    </script>
</body>
</html>
